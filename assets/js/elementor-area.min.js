"use strict";

(function () {
  'use strict';

  (function ($, elm) {
    if (void 0 === window.parent) return;
    var windowParent = window.parent;
    var elementorAreaBuild = {
      onInit: function onInit() {
        this.bindEvents();
      },
      bindEvents: function bindEvents() {
        this.eventElementorEdit();
      },
      eventElementorEdit: function eventElementorEdit() {
        var adminUrl = window.portuna.resturl,
            elementorEdit = elm.config.environmentMode.edit,
            wParent = void 0 !== windowParent.jQuery;
        elementorEdit && windowParent.jQuery('#elementor-editor-dark-mode-css').length > 0 && windowParent.jQuery('body').addClass('elementor-editor-dark-mode');
        elm.hooks.addAction('frontend/element_ready/global', function ($scope) {
          $scope.find('.widgetarea_warper_edit').on('click', function () {
            console.log('Click edit.');
            var modalFrame = windowParent.jQuery('.portuna-addon-modal'),
                iFrame = modalFrame.find('#widgetarea-control-iframe'),
                lightBoxLoad = modalFrame.find('.dialog-lightbox-loading'),
                lightBox = modalFrame.find('.dialog-type-lightbox'),
                key = $(this).parent().attr('data-portuna-key'),
                id = $(this).parent().attr('data-portuna-id'),
                getElementorSrc = adminUrl + 'widgets-content/content_editor/editor/' + key + '-' + id;
            windowParent.jQuery('body').attr('data-portuna-key', key), windowParent.jQuery('body').attr('data-portuna-widget-load', 'false'), lightBox.show(), modalFrame.show(), lightBoxLoad.show(), iFrame.contents().find('#elementor-loading').show(), iFrame.attr('src', getElementorSrc);
            iFrame.on('load', function () {
              lightBoxLoad.hide(), iFrame.show();
            });
            wParent && windowParent.jQuery('.portuna-addon-modal').find('.eicon-close').on('click', function () {
              windowParent.jQuery('body').attr('data-portuna-widget-load', 'true');
            });
          });
        });
      }
    };
    $(window).on('elementor/frontend/init', function () {
      elementorAreaBuild.onInit();
    });
  })(jQuery, window.elementorFrontend);
})();
