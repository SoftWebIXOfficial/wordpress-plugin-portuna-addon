{"version":3,"sources":["mega-menu/assets/js/selectize.js"],"names":["Selectize","$input","settings","key","i","n","dir","input","self","selectize","computedStyle","window","getComputedStyle","getPropertyValue","currentStyle","direction","parents","attr","$","extend","order","tabIndex","tagType","tagName","toLowerCase","TAG_SELECT","TAG_INPUT","rtl","test","eventNS","count","highlightedValue","isBlurring","isOpen","isDisabled","isRequired","is","isInvalid","isLocked","isFocused","isInputHidden","isSetup","isShiftDown","isCmdDown","isCtrlDown","ignoreFocus","ignoreBlur","ignoreHover","hasOptions","currentResults","lastValue","lastValidValue","caretPos","loading","loadedSearches","$activeOption","$activeItems","optgroups","options","userOptions","items","renderCache","onSearchChange","loadThrottle","debounce","sifter","Sifter","diacritics","length","registerOption","registerOptionGroup","mode","maxItems","hideSelected","initializePlugins","plugins","setupCallbacks","setupTemplates","setup","MicroEvent","mixin","MicroPlugin","logError","explanation","prototype","$window","$document","document","$wrapper","$control","$control_input","$dropdown","$dropdown_content","$dropdown_parent","inputMode","timeout_blur","timeout_focus","classes","classes_plugins","inputId","addClass","wrapperClass","inputClass","appendTo","dropdownParent","dropdownClass","hide","dropdownContentClass","copyClassesToDropdown","css","width","style","names","join","placeholder","splitOn","delimiter","delimiterEscaped","replace","RegExp","type","on","e","stopImmediatePropagation","onOptionHover","apply","arguments","onOptionSelect","watchChildEvent","onItemSelect","autoGrow","mousedown","onMouseDown","click","onClick","stopPropagation","keydown","onKeyDown","keyup","onKeyUp","keypress","onKeyPress","resize","positionDropdown","blur","onBlur","focus","onFocus","paste","onPaste","IS_MAC","shiftKey","keyCode","KEY_CTRL","KEY_SHIFT","KEY_CMD","target","parentNode","has","revertSettings","$children","children","detach","tabindex","after","isArray","setValue","SUPPORTS_VALIDITY_API","preventDefault","refreshState","updateOriginalInput","refreshItems","updatePlaceholder","disable","onChange","data","trigger","preload","field_label","labelField","field_optgroup","optgroupLabelField","templates","html","escape","render","fn","callbacks","hasOwnProperty","defaultPrevented","isDefaultPrevented","$target","close","open","setActiveItem","setTimeout","getValue","isFull","pastedText","val","match","splitInput","trim","split","createItem","character","String","fromCharCode","which","create","isInput","KEY_TAB","KEY_A","selectAll","KEY_ESC","KEY_N","ctrlKey","altKey","KEY_DOWN","$next","getAdjacentOption","setActiveOption","KEY_P","KEY_UP","$prev","KEY_RETURN","currentTarget","KEY_LEFT","advanceSelection","KEY_RIGHT","selectOnTab","KEY_BACKSPACE","KEY_DELETE","deleteSelection","metaKey","value","refreshOptions","load","callback","wasFocused","showInput","openOnFocus","dest","activeElement","deactivate","setTextboxValue","setCaret","createOnBlur","$option","hasClass","closeAfterSelect","lastQuery","addItem","getOption","loadingClass","results","Math","max","addOption","removeClass","getTextboxValue","changed","triggerHandler","silent","events","debounce_events","clear","addItems","setMaxItems","$item","eventName","idx","begin","end","item","swap","$last","Array","indexOf","childNodes","push","splice","hideInput","scroll","animate","height_menu","height_item","y","scroll_top","scroll_bottom","isset","height","outerHeight","scrollTop","offset","top","stop","scrollDuration","slice","opacity","position","left","getScoreFunction","query","getSearchOptions","sort","sortField","field","fields","searchField","conjunction","searchConjunction","nesting","search","score","result","calculateScore","Error","hash_key","id","triggerDropdown","j","k","groups","groups_order","option","option_html","optgroup","html_children","has_create_option","$active","$active_before","$create","active_before","maxOptions","min","optgroupField","createDocumentFragment","appendChild","lockOptgroupOrder","a","b","a_order","$order","b_order","domToString","dom","highlight","removeHighlight","tokens","regex","find","canCreate","prepend","addPrecedence","valueField","optgroupValueField","addOptionGroup","removeOptionGroup","clearOptionGroups","updateOption","$item_new","value_new","index_item","cache_items","cache_options","order_old","getItem","replaceWith","removeOption","removeItem","clearOptions","each","getElementWithValue","$options","index","eq","$els","getAttribute","getElementWithTextContent","textContent","ignoreCase","eleTextContent","getFirstItemMatchedByTextContent","values","buffer","isPending","control","insertBefore","firstChild","active","value_next","wasFull","insertAtCaret","remove","persist","caret","lock","formatValueToKey","once","unlock","output","refreshValidityState","refreshClasses","invalid","prop","toggleClass","isEmptyObject","opts","label","escape_html","removeAttr","force","visibility","display","getBoundingClientRect","$el","el","selection","option_select","$option_select","$tail","getSelection","start","onDelete","pop","tail","valueLength","cursorAtEdge","advanceCaret","$adj","$child","before","append","enable","destroy","off","show","removeData","$testInput","undefined","body","templateName","cache","regex_tag","disabledField","clearCache","filter","createFilter"],"mappings":"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","sourcesContent":["var Selectize = function($input, settings) {\n    var key, i, n, dir, input, self = this;\n    input = $input[0];\n    input.selectize = self;\n\n    // detect rtl environment\n    var computedStyle = window.getComputedStyle && window.getComputedStyle(input, null);\n    dir = computedStyle ? computedStyle.getPropertyValue('direction') : input.currentStyle && input.currentStyle.direction;\n    dir = dir || $input.parents('[dir]:first').attr('dir') || '';\n\n    // setup default state\n    $.extend(self, {\n        order            : 0,\n        settings         : settings,\n        $input           : $input,\n        tabIndex         : $input.attr('tabindex') || '',\n        tagType          : input.tagName.toLowerCase() === 'select' ? TAG_SELECT : TAG_INPUT,\n        rtl              : /rtl/i.test(dir),\n\n        eventNS          : '.selectize' + (++Selectize.count),\n        highlightedValue : null,\n        isBlurring       : false,\n        isOpen           : false,\n        isDisabled       : false,\n        isRequired       : $input.is('[required]'),\n        isInvalid        : false,\n        isLocked         : false,\n        isFocused        : false,\n        isInputHidden    : false,\n        isSetup          : false,\n        isShiftDown      : false,\n        isCmdDown        : false,\n        isCtrlDown       : false,\n        ignoreFocus      : false,\n        ignoreBlur       : false,\n        ignoreHover      : false,\n        hasOptions       : false,\n        currentResults   : null,\n        lastValue        : '',\n        lastValidValue   : '',\n        caretPos         : 0,\n        loading          : 0,\n        loadedSearches   : {},\n\n        $activeOption    : null,\n        $activeItems     : [],\n\n        optgroups        : {},\n        options          : {},\n        userOptions      : {},\n        items            : [],\n        renderCache      : {},\n        onSearchChange   : settings.loadThrottle === null ? self.onSearchChange : debounce(self.onSearchChange, settings.loadThrottle)\n    });\n\n    // search system\n    self.sifter = new Sifter(this.options, {diacritics: settings.diacritics});\n\n    // build options table\n    if (self.settings.options) {\n        for (i = 0, n = self.settings.options.length; i < n; i++) {\n            self.registerOption(self.settings.options[i]);\n        }\n        delete self.settings.options;\n    }\n\n    // build optgroup table\n    if (self.settings.optgroups) {\n        for (i = 0, n = self.settings.optgroups.length; i < n; i++) {\n            self.registerOptionGroup(self.settings.optgroups[i]);\n        }\n        delete self.settings.optgroups;\n    }\n\n    // option-dependent defaults\n    self.settings.mode = self.settings.mode || (self.settings.maxItems === 1 ? 'single' : 'multi');\n    if (typeof self.settings.hideSelected !== 'boolean') {\n        self.settings.hideSelected = self.settings.mode === 'multi';\n    }\n\n    self.initializePlugins(self.settings.plugins);\n    self.setupCallbacks();\n    self.setupTemplates();\n    self.setup();\n};\n\n// mixins\n// - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\n\nMicroEvent.mixin(Selectize);\n\nif(typeof MicroPlugin !== \"undefined\"){\n    MicroPlugin.mixin(Selectize);\n}else{\n    logError(\"Dependency MicroPlugin is missing\",\n        {explanation:\n                \"Make sure you either: (1) are using the \\\"standalone\\\" \"+\n                \"version of Selectize, or (2) require MicroPlugin before you \"+\n                \"load Selectize.\"}\n    );\n}\n\n\n// methods\n// - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\n\n$.extend(Selectize.prototype, {\n\n    /**\n     * Creates all elements and sets up event bindings.\n     */\n    setup: function() {\n        var self      = this;\n        var settings  = self.settings;\n        var eventNS   = self.eventNS;\n        var $window   = $(window);\n        var $document = $(document);\n        var $input    = self.$input;\n\n        var $wrapper;\n        var $control;\n        var $control_input;\n        var $dropdown;\n        var $dropdown_content;\n        var $dropdown_parent;\n        var inputMode;\n        var timeout_blur;\n        var timeout_focus;\n        var classes;\n        var classes_plugins;\n        var inputId;\n\n        inputMode         = self.settings.mode;\n        classes           = $input.attr('class') || '';\n\n        $wrapper          = $('<div>').addClass(settings.wrapperClass).addClass(classes).addClass(inputMode);\n        $control          = $('<div>').addClass(settings.inputClass).addClass('items').appendTo($wrapper);\n        $control_input    = $('<input type=\"text\" autocomplete=\"new-password\" autofill=\"no\" />').appendTo($control).attr('tabindex', $input.is(':disabled') ? '-1' : self.tabIndex);\n        $dropdown_parent  = $(settings.dropdownParent || $wrapper);\n        $dropdown         = $('<div>').addClass(settings.dropdownClass).addClass(inputMode).hide().appendTo($dropdown_parent);\n        $dropdown_content = $('<div>').addClass(settings.dropdownContentClass).attr('tabindex', '-1').appendTo($dropdown);\n\n        if(inputId = $input.attr('id')) {\n            $control_input.attr('id', inputId + '-selectized');\n            $(\"label[for='\"+inputId+\"']\").attr('for', inputId + '-selectized');\n        }\n\n        if(self.settings.copyClassesToDropdown) {\n            $dropdown.addClass(classes);\n        }\n\n        $wrapper.css({\n            width: $input[0].style.width\n        });\n\n        if (self.plugins.names.length) {\n            classes_plugins = 'plugin-' + self.plugins.names.join(' plugin-');\n            $wrapper.addClass(classes_plugins);\n            $dropdown.addClass(classes_plugins);\n        }\n\n        if ((settings.maxItems === null || settings.maxItems > 1) && self.tagType === TAG_SELECT) {\n            $input.attr('multiple', 'multiple');\n        }\n\n        if (self.settings.placeholder) {\n            $control_input.attr('placeholder', settings.placeholder);\n        }\n\n        // if splitOn was not passed in, construct it from the delimiter to allow pasting universally\n        if (!self.settings.splitOn && self.settings.delimiter) {\n            var delimiterEscaped = self.settings.delimiter.replace(/[-\\/\\\\^$*+?.()|[\\]{}]/g, '\\\\$&');\n            self.settings.splitOn = new RegExp('\\\\s*' + delimiterEscaped + '+\\\\s*');\n        }\n\n        if ($input.attr('autocorrect')) {\n            $control_input.attr('autocorrect', $input.attr('autocorrect'));\n        }\n\n        if ($input.attr('autocapitalize')) {\n            $control_input.attr('autocapitalize', $input.attr('autocapitalize'));\n        }\n        $control_input[0].type = $input[0].type;\n\n        self.$wrapper          = $wrapper;\n        self.$control          = $control;\n        self.$control_input    = $control_input;\n        self.$dropdown         = $dropdown;\n        self.$dropdown_content = $dropdown_content;\n\n        $dropdown.on('mouseenter mousedown click', '[data-disabled]>[data-selectable]', function(e) { e.stopImmediatePropagation(); });\n        $dropdown.on('mouseenter', '[data-selectable]', function() { return self.onOptionHover.apply(self, arguments); });\n        $dropdown.on('mousedown click', '[data-selectable]', function() { return self.onOptionSelect.apply(self, arguments); });\n        watchChildEvent($control, 'mousedown', '*:not(input)', function() { return self.onItemSelect.apply(self, arguments); });\n        autoGrow($control_input);\n\n        $control.on({\n            mousedown : function() { return self.onMouseDown.apply(self, arguments); },\n            click     : function() { return self.onClick.apply(self, arguments); }\n        });\n\n        $control_input.on({\n            mousedown : function(e) { e.stopPropagation(); },\n            keydown   : function() { return self.onKeyDown.apply(self, arguments); },\n            keyup     : function() { return self.onKeyUp.apply(self, arguments); },\n            keypress  : function() { return self.onKeyPress.apply(self, arguments); },\n            resize    : function() { self.positionDropdown.apply(self, []); },\n            blur      : function() { return self.onBlur.apply(self, arguments); },\n            focus     : function() { self.ignoreBlur = false; return self.onFocus.apply(self, arguments); },\n            paste     : function() { return self.onPaste.apply(self, arguments); }\n        });\n\n        $document.on('keydown' + eventNS, function(e) {\n            self.isCmdDown = e[IS_MAC ? 'metaKey' : 'ctrlKey'];\n            self.isCtrlDown = e[IS_MAC ? 'altKey' : 'ctrlKey'];\n            self.isShiftDown = e.shiftKey;\n        });\n\n        $document.on('keyup' + eventNS, function(e) {\n            if (e.keyCode === KEY_CTRL) self.isCtrlDown = false;\n            if (e.keyCode === KEY_SHIFT) self.isShiftDown = false;\n            if (e.keyCode === KEY_CMD) self.isCmdDown = false;\n        });\n\n        $document.on('mousedown' + eventNS, function(e) {\n            if (self.isFocused) {\n                // prevent events on the dropdown scrollbar from causing the control to blur\n                if (e.target === self.$dropdown[0] || e.target.parentNode === self.$dropdown[0]) {\n                    return false;\n                }\n                // blur on click outside\n                if (!self.$control.has(e.target).length && e.target !== self.$control[0]) {\n                    self.blur(e.target);\n                }\n            }\n        });\n\n        $window.on(['scroll' + eventNS, 'resize' + eventNS].join(' '), function() {\n            if (self.isOpen) {\n                self.positionDropdown.apply(self, arguments);\n            }\n        });\n        $window.on('mousemove' + eventNS, function() {\n            self.ignoreHover = false;\n        });\n\n        // store original children and tab index so that they can be\n        // restored when the destroy() method is called.\n        this.revertSettings = {\n            $children : $input.children().detach(),\n            tabindex  : $input.attr('tabindex')\n        };\n\n        $input.attr('tabindex', -1).hide().after(self.$wrapper);\n\n        if ($.isArray(settings.items)) {\n            self.lastValidValue = settings.items;\n            self.setValue(settings.items);\n            delete settings.items;\n        }\n\n        // feature detect for the validation API\n        if (SUPPORTS_VALIDITY_API) {\n            $input.on('invalid' + eventNS, function(e) {\n                e.preventDefault();\n                self.isInvalid = true;\n                self.refreshState();\n            });\n        }\n\n        self.updateOriginalInput();\n        self.refreshItems();\n        self.refreshState();\n        self.updatePlaceholder();\n        self.isSetup = true;\n\n        if ($input.is(':disabled')) {\n            self.disable();\n        }\n\n        self.on('change', this.onChange);\n\n        $input.data('selectize', self);\n        $input.addClass('selectized');\n        self.trigger('initialize');\n\n        // preload options\n        if (settings.preload === true) {\n            self.onSearchChange('');\n        }\n\n    },\n\n    /**\n     * Sets up default rendering functions.\n     */\n    setupTemplates: function() {\n        var self = this;\n        var field_label = self.settings.labelField;\n        var field_optgroup = self.settings.optgroupLabelField;\n\n        var templates = {\n            'optgroup': function(data) {\n                return '<div class=\"optgroup\">' + data.html + '</div>';\n            },\n            'optgroup_header': function(data, escape) {\n                return '<div class=\"optgroup-header\">' + escape(data[field_optgroup]) + '</div>';\n            },\n            'option': function(data, escape) {\n                return '<div class=\"option\">' + escape(data[field_label]) + '</div>';\n            },\n            'item': function(data, escape) {\n                return '<div class=\"item\">' + escape(data[field_label]) + '</div>';\n            },\n            'option_create': function(data, escape) {\n                return '<div class=\"create\">Add <strong>' + escape(data.input) + '</strong>&hellip;</div>';\n            }\n        };\n\n        self.settings.render = $.extend({}, templates, self.settings.render);\n    },\n\n    /**\n     * Maps fired events to callbacks provided\n     * in the settings used when creating the control.\n     */\n    setupCallbacks: function() {\n        var key, fn, callbacks = {\n            'initialize'      : 'onInitialize',\n            'change'          : 'onChange',\n            'item_add'        : 'onItemAdd',\n            'item_remove'     : 'onItemRemove',\n            'clear'           : 'onClear',\n            'option_add'      : 'onOptionAdd',\n            'option_remove'   : 'onOptionRemove',\n            'option_clear'    : 'onOptionClear',\n            'optgroup_add'    : 'onOptionGroupAdd',\n            'optgroup_remove' : 'onOptionGroupRemove',\n            'optgroup_clear'  : 'onOptionGroupClear',\n            'dropdown_open'   : 'onDropdownOpen',\n            'dropdown_close'  : 'onDropdownClose',\n            'type'            : 'onType',\n            'load'            : 'onLoad',\n            'focus'           : 'onFocus',\n            'blur'            : 'onBlur',\n            'dropdown_item_activate'        : 'onDropdownItemActivate',\n            'dropdown_item_deactivate'      : 'onDropdownItemDeactivate'\n        };\n\n        for (key in callbacks) {\n            if (callbacks.hasOwnProperty(key)) {\n                fn = this.settings[callbacks[key]];\n                if (fn) this.on(key, fn);\n            }\n        }\n    },\n\n    /**\n     * Triggered when the main control element\n     * has a click event.\n     *\n     * @param {object} e\n     * @return {boolean}\n     */\n    onClick: function(e) {\n        var self = this;\n\n        // necessary for mobile webkit devices (manual focus triggering\n        // is ignored unless invoked within a click event)\n        // also necessary to reopen a dropdown that has been closed by\n        // closeAfterSelect\n        if (!self.isFocused || !self.isOpen) {\n            self.focus();\n            e.preventDefault();\n        }\n    },\n\n    /**\n     * Triggered when the main control element\n     * has a mouse down event.\n     *\n     * @param {object} e\n     * @return {boolean}\n     */\n    onMouseDown: function(e) {\n        var self = this;\n        var defaultPrevented = e.isDefaultPrevented();\n        var $target = $(e.target);\n\n        if (self.isFocused) {\n            // retain focus by preventing native handling. if the\n            // event target is the input it should not be modified.\n            // otherwise, text selection within the input won't work.\n            if (e.target !== self.$control_input[0]) {\n                if (self.settings.mode === 'single') {\n                    // toggle dropdown\n                    self.isOpen ? self.close() : self.open();\n                } else if (!defaultPrevented) {\n                    self.setActiveItem(null);\n                }\n                return false;\n            }\n        } else {\n            // give control focus\n            if (!defaultPrevented) {\n                window.setTimeout(function() {\n                    self.focus();\n                }, 0);\n            }\n        }\n    },\n\n    /**\n     * Triggered when the value of the control has been changed.\n     * This should propagate the event to the original DOM\n     * input / select element.\n     */\n    onChange: function() {\n        var self = this;\n        if (self.getValue() !== \"\") {\n            self.lastValidValue = self.getValue();\n        }\n        this.$input.trigger('input');\n        this.$input.trigger('change');\n    },\n\n    /**\n     * Triggered on <input> paste.\n     *\n     * @param {object} e\n     * @returns {boolean}\n     */\n    onPaste: function(e) {\n        var self = this;\n\n        if (self.isFull() || self.isInputHidden || self.isLocked) {\n            e.preventDefault();\n            return;\n        }\n\n        // If a regex or string is included, this will split the pasted\n        // input and create Items for each separate value\n        if (self.settings.splitOn) {\n\n            // Wait for pasted text to be recognized in value\n            setTimeout(function() {\n                var pastedText = self.$control_input.val();\n                if(!pastedText.match(self.settings.splitOn)){ return }\n\n                var splitInput = $.trim(pastedText).split(self.settings.splitOn);\n                for (var i = 0, n = splitInput.length; i < n; i++) {\n                    self.createItem(splitInput[i]);\n                }\n            }, 0);\n        }\n    },\n\n    /**\n     * Triggered on <input> keypress.\n     *\n     * @param {object} e\n     * @returns {boolean}\n     */\n    onKeyPress: function(e) {\n        if (this.isLocked) return e && e.preventDefault();\n        var character = String.fromCharCode(e.keyCode || e.which);\n        if (this.settings.create && this.settings.mode === 'multi' && character === this.settings.delimiter) {\n            this.createItem();\n            e.preventDefault();\n            return false;\n        }\n    },\n\n    /**\n     * Triggered on <input> keydown.\n     *\n     * @param {object} e\n     * @returns {boolean}\n     */\n    onKeyDown: function(e) {\n        var isInput = e.target === this.$control_input[0];\n        var self = this;\n\n        if (self.isLocked) {\n            if (e.keyCode !== KEY_TAB) {\n                e.preventDefault();\n            }\n            return;\n        }\n\n        switch (e.keyCode) {\n            case KEY_A:\n                if (self.isCmdDown) {\n                    self.selectAll();\n                    return;\n                }\n                break;\n            case KEY_ESC:\n                if (self.isOpen) {\n                    e.preventDefault();\n                    e.stopPropagation();\n                    self.close();\n                }\n                return;\n            case KEY_N:\n                if (!e.ctrlKey || e.altKey) break;\n            case KEY_DOWN:\n                if (!self.isOpen && self.hasOptions) {\n                    self.open();\n                } else if (self.$activeOption) {\n                    self.ignoreHover = true;\n                    var $next = self.getAdjacentOption(self.$activeOption, 1);\n                    if ($next.length) self.setActiveOption($next, true, true);\n                }\n                e.preventDefault();\n                return;\n            case KEY_P:\n                if (!e.ctrlKey || e.altKey) break;\n            case KEY_UP:\n                if (self.$activeOption) {\n                    self.ignoreHover = true;\n                    var $prev = self.getAdjacentOption(self.$activeOption, -1);\n                    if ($prev.length) self.setActiveOption($prev, true, true);\n                }\n                e.preventDefault();\n                return;\n            case KEY_RETURN:\n                if (self.isOpen && self.$activeOption) {\n                    self.onOptionSelect({currentTarget: self.$activeOption});\n                    e.preventDefault();\n                }\n                return;\n            case KEY_LEFT:\n                self.advanceSelection(-1, e);\n                return;\n            case KEY_RIGHT:\n                self.advanceSelection(1, e);\n                return;\n            case KEY_TAB:\n                if (self.settings.selectOnTab && self.isOpen && self.$activeOption) {\n                    self.onOptionSelect({currentTarget: self.$activeOption});\n\n                    // Default behaviour is to jump to the next field, we only want this\n                    // if the current field doesn't accept any more entries\n                    if (!self.isFull()) {\n                        e.preventDefault();\n                    }\n                }\n                if (self.settings.create && self.createItem()) {\n                    e.preventDefault();\n                }\n                return;\n            case KEY_BACKSPACE:\n            case KEY_DELETE:\n                self.deleteSelection(e);\n                return;\n        }\n\n        if ((self.isFull() || self.isInputHidden) && !(IS_MAC ? e.metaKey : e.ctrlKey)) {\n            e.preventDefault();\n            return;\n        }\n    },\n\n    /**\n     * Triggered on <input> keyup.\n     *\n     * @param {object} e\n     * @returns {boolean}\n     */\n    onKeyUp: function(e) {\n        var self = this;\n\n        if (self.isLocked) return e && e.preventDefault();\n        var value = self.$control_input.val() || '';\n        if (self.lastValue !== value) {\n            self.lastValue = value;\n            self.onSearchChange(value);\n            self.refreshOptions();\n            self.trigger('type', value);\n        }\n    },\n\n    /**\n     * Invokes the user-provide option provider / loader.\n     *\n     * Note: this function is debounced in the Selectize\n     * constructor (by `settings.loadThrottle` milliseconds)\n     *\n     * @param {string} value\n     */\n    onSearchChange: function(value) {\n        var self = this;\n        var fn = self.settings.load;\n        if (!fn) return;\n        if (self.loadedSearches.hasOwnProperty(value)) return;\n        self.loadedSearches[value] = true;\n        self.load(function(callback) {\n            fn.apply(self, [value, callback]);\n        });\n    },\n\n    /**\n     * Triggered on <input> focus.\n     *\n     * @param {object} e (optional)\n     * @returns {boolean}\n     */\n    onFocus: function(e) {\n        var self = this;\n        var wasFocused = self.isFocused;\n\n        if (self.isDisabled) {\n            self.blur();\n            e && e.preventDefault();\n            return false;\n        }\n\n        if (self.ignoreFocus) return;\n        self.isFocused = true;\n        if (self.settings.preload === 'focus') self.onSearchChange('');\n\n        if (!wasFocused) self.trigger('focus');\n\n        if (!self.$activeItems.length) {\n            self.showInput();\n            self.setActiveItem(null);\n            self.refreshOptions(!!self.settings.openOnFocus);\n        }\n\n        self.refreshState();\n    },\n\n    /**\n     * Triggered on <input> blur.\n     *\n     * @param {object} e\n     * @param {Element} dest\n     */\n    onBlur: function(e, dest) {\n        var self = this;\n        if (!self.isFocused) return;\n        self.isFocused = false;\n\n        if (self.ignoreFocus) {\n            return;\n        } else if (!self.ignoreBlur && document.activeElement === self.$dropdown_content[0]) {\n            // necessary to prevent IE closing the dropdown when the scrollbar is clicked\n            self.ignoreBlur = true;\n            self.onFocus(e);\n            return;\n        }\n\n        var deactivate = function() {\n            self.close();\n            self.setTextboxValue('');\n            self.setActiveItem(null);\n            self.setActiveOption(null);\n            self.setCaret(self.items.length);\n            self.refreshState();\n\n            // IE11 bug: element still marked as active\n            dest && dest.focus && dest.focus();\n\n            self.isBlurring = false;\n            self.ignoreFocus = false;\n            self.trigger('blur');\n        };\n\n        self.isBlurring = true;\n        self.ignoreFocus = true;\n        if (self.settings.create && self.settings.createOnBlur) {\n            self.createItem(null, false, deactivate);\n        } else {\n            deactivate();\n        }\n    },\n\n    /**\n     * Triggered when the user rolls over\n     * an option in the autocomplete dropdown menu.\n     *\n     * @param {object} e\n     * @returns {boolean}\n     */\n    onOptionHover: function(e) {\n        if (this.ignoreHover) return;\n        this.setActiveOption(e.currentTarget, false);\n    },\n\n    /**\n     * Triggered when the user clicks on an option\n     * in the autocomplete dropdown menu.\n     *\n     * @param {object} e\n     * @returns {boolean}\n     */\n    onOptionSelect: function(e) {\n        var value, $target, $option, self = this;\n\n        if (e.preventDefault) {\n            e.preventDefault();\n            e.stopPropagation();\n        }\n\n        $target = $(e.currentTarget);\n        if ($target.hasClass('create')) {\n            self.createItem(null, function() {\n                if (self.settings.closeAfterSelect) {\n                    self.close();\n                }\n            });\n        } else {\n            value = $target.attr('data-value');\n            if (typeof value !== 'undefined') {\n                self.lastQuery = null;\n                self.setTextboxValue('');\n                self.addItem(value);\n                if (self.settings.closeAfterSelect) {\n                    self.close();\n                } else if (!self.settings.hideSelected && e.type && /mouse/.test(e.type)) {\n                    self.setActiveOption(self.getOption(value));\n                }\n            }\n        }\n    },\n\n    /**\n     * Triggered when the user clicks on an item\n     * that has been selected.\n     *\n     * @param {object} e\n     * @returns {boolean}\n     */\n    onItemSelect: function(e) {\n        var self = this;\n\n        if (self.isLocked) return;\n        if (self.settings.mode === 'multi') {\n            e.preventDefault();\n            self.setActiveItem(e.currentTarget, e);\n        }\n    },\n\n    /**\n     * Invokes the provided method that provides\n     * results to a callback---which are then added\n     * as options to the control.\n     *\n     * @param {function} fn\n     */\n    load: function(fn) {\n        var self = this;\n        var $wrapper = self.$wrapper.addClass(self.settings.loadingClass);\n\n        self.loading++;\n        fn.apply(self, [function(results) {\n            self.loading = Math.max(self.loading - 1, 0);\n            if (results && results.length) {\n                self.addOption(results);\n                self.refreshOptions(self.isFocused && !self.isInputHidden);\n            }\n            if (!self.loading) {\n                $wrapper.removeClass(self.settings.loadingClass);\n            }\n            self.trigger('load', results);\n        }]);\n    },\n\n    /**\n     * Gets the value of input field of the control.\n     *\n     * @returns {string} value\n     */\n    getTextboxValue: function() {\n        var $input = this.$control_input;\n        return $input.val();\n    },\n\n    /**\n     * Sets the input field of the control to the specified value.\n     *\n     * @param {string} value\n     */\n    setTextboxValue: function(value) {\n        var $input = this.$control_input;\n        var changed = $input.val() !== value;\n        if (changed) {\n            $input.val(value).triggerHandler('update');\n            this.lastValue = value;\n        }\n    },\n\n    /**\n     * Returns the value of the control. If multiple items\n     * can be selected (e.g. <select multiple>), this returns\n     * an array. If only one item can be selected, this\n     * returns a string.\n     *\n     * @returns {mixed}\n     */\n    getValue: function() {\n        if (this.tagType === TAG_SELECT && this.$input.attr('multiple')) {\n            return this.items;\n        } else {\n            return this.items.join(this.settings.delimiter);\n        }\n    },\n\n    /**\n     * Resets the selected items to the given value.\n     *\n     * @param {mixed} value\n     */\n    setValue: function(value, silent) {\n        var events = silent ? [] : ['change'];\n\n        debounce_events(this, events, function() {\n            this.clear(silent);\n            this.addItems(value, silent);\n        });\n    },\n\n    /**\n     * Resets the number of max items to the given value\n     *\n     * @param {number} value\n     */\n    setMaxItems: function(value){\n        if(value === 0) value = null; //reset to unlimited items.\n        this.settings.maxItems = value;\n        this.settings.mode = this.settings.mode || (this.settings.maxItems === 1 ? 'single' : 'multi');\n        this.refreshState();\n    },\n\n    /**\n     * Sets the selected item.\n     *\n     * @param {object} $item\n     * @param {object} e (optional)\n     */\n    setActiveItem: function($item, e) {\n        var self = this;\n        var eventName;\n        var i, idx, begin, end, item, swap;\n        var $last;\n\n        if (self.settings.mode === 'single') return;\n        $item = $($item);\n\n        // clear the active selection\n        if (!$item.length) {\n            $(self.$activeItems).removeClass('active');\n            self.$activeItems = [];\n            if (self.isFocused) {\n                self.showInput();\n            }\n            return;\n        }\n\n        // modify selection\n        eventName = e && e.type.toLowerCase();\n\n        if (eventName === 'mousedown' && self.isShiftDown && self.$activeItems.length) {\n            $last = self.$control.children('.active:last');\n            begin = Array.prototype.indexOf.apply(self.$control[0].childNodes, [$last[0]]);\n            end   = Array.prototype.indexOf.apply(self.$control[0].childNodes, [$item[0]]);\n            if (begin > end) {\n                swap  = begin;\n                begin = end;\n                end   = swap;\n            }\n            for (i = begin; i <= end; i++) {\n                item = self.$control[0].childNodes[i];\n                if (self.$activeItems.indexOf(item) === -1) {\n                    $(item).addClass('active');\n                    self.$activeItems.push(item);\n                }\n            }\n            e.preventDefault();\n        } else if ((eventName === 'mousedown' && self.isCtrlDown) || (eventName === 'keydown' && this.isShiftDown)) {\n            if ($item.hasClass('active')) {\n                idx = self.$activeItems.indexOf($item[0]);\n                self.$activeItems.splice(idx, 1);\n                $item.removeClass('active');\n            } else {\n                self.$activeItems.push($item.addClass('active')[0]);\n            }\n        } else {\n            $(self.$activeItems).removeClass('active');\n            self.$activeItems = [$item.addClass('active')[0]];\n        }\n\n        // ensure control has focus\n        self.hideInput();\n        if (!this.isFocused) {\n            self.focus();\n        }\n    },\n\n    /**\n     * Sets the selected item in the dropdown menu\n     * of available options.\n     *\n     * @param {object} $object\n     * @param {boolean} scroll\n     * @param {boolean} animate\n     */\n    setActiveOption: function($option, scroll, animate) {\n        var height_menu, height_item, y;\n        var scroll_top, scroll_bottom;\n        var self = this;\n\n        if (self.$activeOption) {\n            self.$activeOption.removeClass('active');\n            self.trigger('dropdown_item_deactivate', self.$activeOption.attr('data-value'));\n        }\n        self.$activeOption = null;\n\n        $option = $($option);\n        if (!$option.length) return;\n\n        self.$activeOption = $option.addClass('active');\n        if (self.isOpen) self.trigger('dropdown_item_activate', self.$activeOption.attr('data-value'));\n\n        if (scroll || !isset(scroll)) {\n\n            height_menu   = self.$dropdown_content.height();\n            height_item   = self.$activeOption.outerHeight(true);\n            scroll        = self.$dropdown_content.scrollTop() || 0;\n            y             = self.$activeOption.offset().top - self.$dropdown_content.offset().top + scroll;\n            scroll_top    = y;\n            scroll_bottom = y - height_menu + height_item;\n\n            if (y + height_item > height_menu + scroll) {\n                self.$dropdown_content.stop().animate({scrollTop: scroll_bottom}, animate ? self.settings.scrollDuration : 0);\n            } else if (y < scroll) {\n                self.$dropdown_content.stop().animate({scrollTop: scroll_top}, animate ? self.settings.scrollDuration : 0);\n            }\n\n        }\n    },\n\n    /**\n     * Selects all items (CTRL + A).\n     */\n    selectAll: function() {\n        var self = this;\n        if (self.settings.mode === 'single') return;\n\n        self.$activeItems = Array.prototype.slice.apply(self.$control.children(':not(input)').addClass('active'));\n        if (self.$activeItems.length) {\n            self.hideInput();\n            self.close();\n        }\n        self.focus();\n    },\n\n    /**\n     * Hides the input element out of view, while\n     * retaining its focus.\n     */\n    hideInput: function() {\n        var self = this;\n\n        self.setTextboxValue('');\n        self.$control_input.css({opacity: 0, position: 'absolute', left: self.rtl ? 10000 : -10000});\n        self.isInputHidden = true;\n    },\n\n    /**\n     * Restores input visibility.\n     */\n    showInput: function() {\n        this.$control_input.css({opacity: 1, position: 'relative', left: 0});\n        this.isInputHidden = false;\n    },\n\n    /**\n     * Gives the control focus.\n     */\n    focus: function() {\n        var self = this;\n        if (self.isDisabled) return self;\n\n        self.ignoreFocus = true;\n        self.$control_input[0].focus();\n        window.setTimeout(function() {\n            self.ignoreFocus = false;\n            self.onFocus();\n        }, 0);\n        return self;\n    },\n\n    /**\n     * Forces the control out of focus.\n     *\n     * @param {Element} dest\n     */\n    blur: function(dest) {\n        this.$control_input[0].blur();\n        this.onBlur(null, dest);\n        return this;\n    },\n\n    /**\n     * Returns a function that scores an object\n     * to show how good of a match it is to the\n     * provided query.\n     *\n     * @param {string} query\n     * @param {object} options\n     * @return {function}\n     */\n    getScoreFunction: function(query) {\n        return this.sifter.getScoreFunction(query, this.getSearchOptions());\n    },\n\n    /**\n     * Returns search options for sifter (the system\n     * for scoring and sorting results).\n     *\n     * @see https://github.com/brianreavis/sifter.js\n     * @return {object}\n     */\n    getSearchOptions: function() {\n        var settings = this.settings;\n        var sort = settings.sortField;\n        if (typeof sort === 'string') {\n            sort = [{field: sort}];\n        }\n\n        return {\n            fields      : settings.searchField,\n            conjunction : settings.searchConjunction,\n            sort        : sort,\n            nesting     : settings.nesting\n        };\n    },\n\n    /**\n     * Searches through available options and returns\n     * a sorted array of matches.\n     *\n     * Returns an object containing:\n     *\n     *   - query {string}\n     *   - tokens {array}\n     *   - total {int}\n     *   - items {array}\n     *\n     * @param {string} query\n     * @returns {object}\n     */\n    search: function(query) {\n        var i, value, score, result, calculateScore;\n        var self     = this;\n        var settings = self.settings;\n        var options  = this.getSearchOptions();\n\n        // validate user-provided result scoring function\n        if (settings.score) {\n            calculateScore = self.settings.score.apply(this, [query]);\n            if (typeof calculateScore !== 'function') {\n                throw new Error('Selectize \"score\" setting must be a function that returns a function');\n            }\n        }\n\n        // perform search\n        if (query !== self.lastQuery) {\n            self.lastQuery = query;\n            result = self.sifter.search(query, $.extend(options, {score: calculateScore}));\n            self.currentResults = result;\n        } else {\n            result = $.extend(true, {}, self.currentResults);\n        }\n\n        // filter out selected items\n        if (settings.hideSelected) {\n            for (i = result.items.length - 1; i >= 0; i--) {\n                if (self.items.indexOf(hash_key(result.items[i].id)) !== -1) {\n                    result.items.splice(i, 1);\n                }\n            }\n        }\n\n        return result;\n    },\n\n    /**\n     * Refreshes the list of available options shown\n     * in the autocomplete dropdown menu.\n     *\n     * @param {boolean} triggerDropdown\n     */\n    refreshOptions: function(triggerDropdown) {\n        var i, j, k, n, groups, groups_order, option, option_html, optgroup, optgroups, html, html_children, has_create_option;\n        var $active, $active_before, $create;\n\n        if (typeof triggerDropdown === 'undefined') {\n            triggerDropdown = true;\n        }\n\n        var self              = this;\n        var query             = $.trim(self.$control_input.val());\n        var results           = self.search(query);\n        var $dropdown_content = self.$dropdown_content;\n        var active_before     = self.$activeOption && hash_key(self.$activeOption.attr('data-value'));\n\n        // build markup\n        n = results.items.length;\n        if (typeof self.settings.maxOptions === 'number') {\n            n = Math.min(n, self.settings.maxOptions);\n        }\n\n        // render and group available options individually\n        groups = {};\n        groups_order = [];\n\n        for (i = 0; i < n; i++) {\n            option      = self.options[results.items[i].id];\n            option_html = self.render('option', option);\n            optgroup    = option[self.settings.optgroupField] || '';\n            optgroups   = $.isArray(optgroup) ? optgroup : [optgroup];\n\n            for (j = 0, k = optgroups && optgroups.length; j < k; j++) {\n                optgroup = optgroups[j];\n                if (!self.optgroups.hasOwnProperty(optgroup)) {\n                    optgroup = '';\n                }\n                if (!groups.hasOwnProperty(optgroup)) {\n                    groups[optgroup] = document.createDocumentFragment();\n                    groups_order.push(optgroup);\n                }\n                groups[optgroup].appendChild(option_html);\n            }\n        }\n\n        // sort optgroups\n        if (this.settings.lockOptgroupOrder) {\n            groups_order.sort(function(a, b) {\n                var a_order = self.optgroups[a] && self.optgroups[a].$order || 0;\n                var b_order = self.optgroups[b] && self.optgroups[b].$order || 0;\n                return a_order - b_order;\n            });\n        }\n\n        // render optgroup headers & join groups\n        html = document.createDocumentFragment();\n        for (i = 0, n = groups_order.length; i < n; i++) {\n            optgroup = groups_order[i];\n            if (self.optgroups.hasOwnProperty(optgroup) && groups[optgroup].childNodes.length) {\n                // render the optgroup header and options within it,\n                // then pass it to the wrapper template\n                html_children = document.createDocumentFragment();\n                html_children.appendChild(self.render('optgroup_header', self.optgroups[optgroup]));\n                html_children.appendChild(groups[optgroup]);\n\n                html.appendChild(self.render('optgroup', $.extend({}, self.optgroups[optgroup], {\n                    html: domToString(html_children),\n                    dom:  html_children\n                })));\n            } else {\n                html.appendChild(groups[optgroup]);\n            }\n        }\n\n        $dropdown_content.html(html);\n\n        // highlight matching terms inline\n        if (self.settings.highlight) {\n            $dropdown_content.removeHighlight();\n            if (results.query.length && results.tokens.length) {\n                for (i = 0, n = results.tokens.length; i < n; i++) {\n                    highlight($dropdown_content, results.tokens[i].regex);\n                }\n            }\n        }\n\n        // add \"selected\" class to selected options\n        if (!self.settings.hideSelected) {\n            // clear selection on all previously selected elements first\n            self.$dropdown.find('.selected').removeClass('selected');\n\n            for (i = 0, n = self.items.length; i < n; i++) {\n                self.getOption(self.items[i]).addClass('selected');\n            }\n        }\n\n        // add create option\n        has_create_option = self.canCreate(query);\n        if (has_create_option) {\n            $dropdown_content.prepend(self.render('option_create', {input: query}));\n            $create = $($dropdown_content[0].childNodes[0]);\n        }\n\n        // activate\n        self.hasOptions = results.items.length > 0 || has_create_option;\n        if (self.hasOptions) {\n            if (results.items.length > 0) {\n                $active_before = active_before && self.getOption(active_before);\n                if (results.query !== \"\" && $active_before && $active_before.length) {\n                    $active = $active_before;\n                } else if (self.settings.mode === 'single' && self.items.length) {\n                    $active = self.getOption(self.items[0]);\n                }\n                if (!$active || !$active.length) {\n                    if ($create && !self.settings.addPrecedence) {\n                        $active = self.getAdjacentOption($create, 1);\n                    } else {\n                        $active = $dropdown_content.find('[data-selectable]:first');\n                    }\n                }\n            } else {\n                $active = $create;\n            }\n            self.setActiveOption($active);\n            if (triggerDropdown && !self.isOpen) { self.open(); }\n        } else {\n            self.setActiveOption(null);\n            if (triggerDropdown && self.isOpen) { self.close(); }\n        }\n    },\n\n    /**\n     * Adds an available option. If it already exists,\n     * nothing will happen. Note: this does not refresh\n     * the options list dropdown (use `refreshOptions`\n     * for that).\n     *\n     * Usage:\n     *\n     *   this.addOption(data)\n     *\n     * @param {object|array} data\n     */\n    addOption: function(data) {\n        var i, n, value, self = this;\n\n        if ($.isArray(data)) {\n            for (i = 0, n = data.length; i < n; i++) {\n                self.addOption(data[i]);\n            }\n            return;\n        }\n\n        if (value = self.registerOption(data)) {\n            self.userOptions[value] = true;\n            self.lastQuery = null;\n            self.trigger('option_add', value, data);\n        }\n    },\n\n    /**\n     * Registers an option to the pool of options.\n     *\n     * @param {object} data\n     * @return {boolean|string}\n     */\n    registerOption: function(data) {\n        var key = hash_key(data[this.settings.valueField]);\n        if (typeof key === 'undefined' || key === null || this.options.hasOwnProperty(key)) return false;\n        data.$order = data.$order || ++this.order;\n        this.options[key] = data;\n        return key;\n    },\n\n    /**\n     * Registers an option group to the pool of option groups.\n     *\n     * @param {object} data\n     * @return {boolean|string}\n     */\n    registerOptionGroup: function(data) {\n        var key = hash_key(data[this.settings.optgroupValueField]);\n        if (!key) return false;\n\n        data.$order = data.$order || ++this.order;\n        this.optgroups[key] = data;\n        return key;\n    },\n\n    /**\n     * Registers a new optgroup for options\n     * to be bucketed into.\n     *\n     * @param {string} id\n     * @param {object} data\n     */\n    addOptionGroup: function(id, data) {\n        data[this.settings.optgroupValueField] = id;\n        if (id = this.registerOptionGroup(data)) {\n            this.trigger('optgroup_add', id, data);\n        }\n    },\n\n    /**\n     * Removes an existing option group.\n     *\n     * @param {string} id\n     */\n    removeOptionGroup: function(id) {\n        if (this.optgroups.hasOwnProperty(id)) {\n            delete this.optgroups[id];\n            this.renderCache = {};\n            this.trigger('optgroup_remove', id);\n        }\n    },\n\n    /**\n     * Clears all existing option groups.\n     */\n    clearOptionGroups: function() {\n        this.optgroups = {};\n        this.renderCache = {};\n        this.trigger('optgroup_clear');\n    },\n\n    /**\n     * Updates an option available for selection. If\n     * it is visible in the selected items or options\n     * dropdown, it will be re-rendered automatically.\n     *\n     * @param {string} value\n     * @param {object} data\n     */\n    updateOption: function(value, data) {\n        var self = this;\n        var $item, $item_new;\n        var value_new, index_item, cache_items, cache_options, order_old;\n\n        value     = hash_key(value);\n        value_new = hash_key(data[self.settings.valueField]);\n\n        // sanity checks\n        if (value === null) return;\n        if (!self.options.hasOwnProperty(value)) return;\n        if (typeof value_new !== 'string') throw new Error('Value must be set in option data');\n\n        order_old = self.options[value].$order;\n\n        // update references\n        if (value_new !== value) {\n            delete self.options[value];\n            index_item = self.items.indexOf(value);\n            if (index_item !== -1) {\n                self.items.splice(index_item, 1, value_new);\n            }\n        }\n        data.$order = data.$order || order_old;\n        self.options[value_new] = data;\n\n        // invalidate render cache\n        cache_items = self.renderCache['item'];\n        cache_options = self.renderCache['option'];\n\n        if (cache_items) {\n            delete cache_items[value];\n            delete cache_items[value_new];\n        }\n        if (cache_options) {\n            delete cache_options[value];\n            delete cache_options[value_new];\n        }\n\n        // update the item if it's selected\n        if (self.items.indexOf(value_new) !== -1) {\n            $item = self.getItem(value);\n            $item_new = $(self.render('item', data));\n            if ($item.hasClass('active')) $item_new.addClass('active');\n            $item.replaceWith($item_new);\n        }\n\n        // invalidate last query because we might have updated the sortField\n        self.lastQuery = null;\n\n        // update dropdown contents\n        if (self.isOpen) {\n            self.refreshOptions(false);\n        }\n    },\n\n    /**\n     * Removes a single option.\n     *\n     * @param {string} value\n     * @param {boolean} silent\n     */\n    removeOption: function(value, silent) {\n        var self = this;\n        value = hash_key(value);\n\n        var cache_items = self.renderCache['item'];\n        var cache_options = self.renderCache['option'];\n        if (cache_items) delete cache_items[value];\n        if (cache_options) delete cache_options[value];\n\n        delete self.userOptions[value];\n        delete self.options[value];\n        self.lastQuery = null;\n        self.trigger('option_remove', value);\n        self.removeItem(value, silent);\n    },\n\n    /**\n     * Clears all options.\n     *\n     * @param {boolean} silent\n     */\n    clearOptions: function(silent) {\n        var self = this;\n\n        self.loadedSearches = {};\n        self.userOptions = {};\n        self.renderCache = {};\n        var options = self.options;\n        $.each(self.options, function(key, value) {\n            if(self.items.indexOf(key) == -1) {\n                delete options[key];\n            }\n        });\n        self.options = self.sifter.items = options;\n        self.lastQuery = null;\n        self.trigger('option_clear');\n        self.clear(silent);\n    },\n\n    /**\n     * Returns the jQuery element of the option\n     * matching the given value.\n     *\n     * @param {string} value\n     * @returns {object}\n     */\n    getOption: function(value) {\n        return this.getElementWithValue(value, this.$dropdown_content.find('[data-selectable]'));\n    },\n\n    /**\n     * Returns the jQuery element of the next or\n     * previous selectable option.\n     *\n     * @param {object} $option\n     * @param {int} direction  can be 1 for next or -1 for previous\n     * @return {object}\n     */\n    getAdjacentOption: function($option, direction) {\n        var $options = this.$dropdown.find('[data-selectable]');\n        var index    = $options.index($option) + direction;\n\n        return index >= 0 && index < $options.length ? $options.eq(index) : $();\n    },\n\n    /**\n     * Finds the first element with a \"data-value\" attribute\n     * that matches the given value.\n     *\n     * @param {mixed} value\n     * @param {object} $els\n     * @return {object}\n     */\n    getElementWithValue: function(value, $els) {\n        value = hash_key(value);\n\n        if (typeof value !== 'undefined' && value !== null) {\n            for (var i = 0, n = $els.length; i < n; i++) {\n                if ($els[i].getAttribute('data-value') === value) {\n                    return $($els[i]);\n                }\n            }\n        }\n\n        return $();\n    },\n\n    /**\n     * Finds the first element with a \"textContent\" property\n     * that matches the given textContent value.\n     *\n     * @param {mixed} textContent\n     * @param {boolean} ignoreCase\n     * @param {object} $els\n     * @return {object}\n     */\n    getElementWithTextContent: function(textContent, ignoreCase ,$els) {\n        textContent = hash_key(textContent);\n\n        if (typeof textContent !== 'undefined' && textContent !== null) {\n            for (var i = 0, n = $els.length; i < n; i++) {\n                var eleTextContent = $els[i].textContent\n                if (ignoreCase == true) {\n                    eleTextContent = (eleTextContent !== null) ? eleTextContent.toLowerCase() : null;\n                    textContent = textContent.toLowerCase();\n                }\n                if (eleTextContent === textContent) {\n                    return $($els[i]);\n                }\n            }\n        }\n\n        return $();\n    },\n\n    /**\n     * Returns the jQuery element of the item\n     * matching the given value.\n     *\n     * @param {string} value\n     * @returns {object}\n     */\n    getItem: function(value) {\n        return this.getElementWithValue(value, this.$control.children());\n    },\n\n    /**\n     * Returns the jQuery element of the item\n     * matching the given textContent.\n     *\n     * @param {string} value\n     * @param {boolean} ignoreCase\n     * @returns {object}\n     */\n    getFirstItemMatchedByTextContent: function(textContent, ignoreCase) {\n        ignoreCase = (ignoreCase !== null && ignoreCase === true) ? true : false;\n        return this.getElementWithTextContent(textContent, ignoreCase, this.$dropdown_content.find('[data-selectable]'));\n    },\n\n    /**\n     * \"Selects\" multiple items at once. Adds them to the list\n     * at the current caret position.\n     *\n     * @param {string} value\n     * @param {boolean} silent\n     */\n    addItems: function(values, silent) {\n        this.buffer = document.createDocumentFragment();\n\n        var childNodes = this.$control[0].childNodes;\n        for (var i = 0; i < childNodes.length; i++) {\n            this.buffer.appendChild(childNodes[i]);\n        }\n\n        var items = $.isArray(values) ? values : [values];\n        for (var i = 0, n = items.length; i < n; i++) {\n            this.isPending = (i < n - 1);\n            this.addItem(items[i], silent);\n        }\n\n        var control = this.$control[0];\n        control.insertBefore(this.buffer, control.firstChild);\n\n        this.buffer = null;\n    },\n\n    /**\n     * \"Selects\" an item. Adds it to the list\n     * at the current caret position.\n     *\n     * @param {string} value\n     * @param {boolean} silent\n     */\n    addItem: function(value, silent) {\n        var events = silent ? [] : ['change'];\n\n        debounce_events(this, events, function() {\n            var $item, $option, $options;\n            var self = this;\n            var inputMode = self.settings.mode;\n            var i, active, value_next, wasFull;\n            value = hash_key(value);\n\n            if (self.items.indexOf(value) !== -1) {\n                if (inputMode === 'single') self.close();\n                return;\n            }\n\n            if (!self.options.hasOwnProperty(value)) return;\n            if (inputMode === 'single') self.clear(silent);\n            if (inputMode === 'multi' && self.isFull()) return;\n\n            $item = $(self.render('item', self.options[value]));\n            wasFull = self.isFull();\n            self.items.splice(self.caretPos, 0, value);\n            self.insertAtCaret($item);\n            if (!self.isPending || (!wasFull && self.isFull())) {\n                self.refreshState();\n            }\n\n            if (self.isSetup) {\n                $options = self.$dropdown_content.find('[data-selectable]');\n\n                // update menu / remove the option (if this is not one item being added as part of series)\n                if (!self.isPending) {\n                    $option = self.getOption(value);\n                    value_next = self.getAdjacentOption($option, 1).attr('data-value');\n                    self.refreshOptions(self.isFocused && inputMode !== 'single');\n                    if (value_next) {\n                        self.setActiveOption(self.getOption(value_next));\n                    }\n                }\n\n                // hide the menu if the maximum number of items have been selected or no options are left\n                if (!$options.length || self.isFull()) {\n                    self.close();\n                } else if (!self.isPending) {\n                    self.positionDropdown();\n                }\n\n                self.updatePlaceholder();\n                self.trigger('item_add', value, $item);\n\n                if (!self.isPending) {\n                    self.updateOriginalInput({silent: silent});\n                }\n            }\n        });\n    },\n\n    /**\n     * Removes the selected item matching\n     * the provided value.\n     *\n     * @param {string} value\n     */\n    removeItem: function(value, silent) {\n        var self = this;\n        var $item, i, idx;\n\n        $item = (value instanceof $) ? value : self.getItem(value);\n        value = hash_key($item.attr('data-value'));\n        i = self.items.indexOf(value);\n\n        if (i !== -1) {\n            self.trigger('item_before_remove', value, $item);\n            $item.remove();\n            if ($item.hasClass('active')) {\n                idx = self.$activeItems.indexOf($item[0]);\n                self.$activeItems.splice(idx, 1);\n            }\n\n            self.items.splice(i, 1);\n            self.lastQuery = null;\n            if (!self.settings.persist && self.userOptions.hasOwnProperty(value)) {\n                self.removeOption(value, silent);\n            }\n\n            if (i < self.caretPos) {\n                self.setCaret(self.caretPos - 1);\n            }\n\n            self.refreshState();\n            self.updatePlaceholder();\n            self.updateOriginalInput({silent: silent});\n            self.positionDropdown();\n            self.trigger('item_remove', value, $item);\n        }\n    },\n\n    /**\n     * Invokes the `create` method provided in the\n     * selectize options that should provide the data\n     * for the new item, given the user input.\n     *\n     * Once this completes, it will be added\n     * to the item list.\n     *\n     * @param {string} value\n     * @param {boolean} [triggerDropdown]\n     * @param {function} [callback]\n     * @return {boolean}\n     */\n    createItem: function(input, triggerDropdown) {\n        var self  = this;\n        var caret = self.caretPos;\n        input = input || $.trim(self.$control_input.val() || '');\n\n        var callback = arguments[arguments.length - 1];\n        if (typeof callback !== 'function') callback = function() {};\n\n        if (typeof triggerDropdown !== 'boolean') {\n            triggerDropdown = true;\n        }\n\n        if (!self.canCreate(input)) {\n            callback();\n            return false;\n        }\n\n        self.lock();\n\n        var setup = (typeof self.settings.create === 'function') ? this.settings.create : function(input) {\n            var data = {};\n            data[self.settings.labelField] = input;\n            var key = input;\n            if ( self.settings.formatValueToKey && typeof self.settings.formatValueToKey === 'function' ) {\n                key = self.settings.formatValueToKey.apply(this, [key]);\n                if (key === null || typeof key === 'undefined' || typeof key === 'object' || typeof key === 'function') {\n                    throw new Error('Selectize \"formatValueToKey\" setting must be a function that returns a value other than object or function.');\n                }\n            }\n            data[self.settings.valueField] = key;\n            return data;\n        };\n\n        var create = once(function(data) {\n            self.unlock();\n\n            if (!data || typeof data !== 'object') return callback();\n            var value = hash_key(data[self.settings.valueField]);\n            if (typeof value !== 'string') return callback();\n\n            self.setTextboxValue('');\n            self.addOption(data);\n            self.setCaret(caret);\n            self.addItem(value);\n            self.refreshOptions(triggerDropdown && self.settings.mode !== 'single');\n            callback(data);\n        });\n\n        var output = setup.apply(this, [input, create]);\n        if (typeof output !== 'undefined') {\n            create(output);\n        }\n\n        return true;\n    },\n\n    /**\n     * Re-renders the selected item lists.\n     */\n    refreshItems: function() {\n        this.lastQuery = null;\n\n        if (this.isSetup) {\n            this.addItem(this.items);\n        }\n\n        this.refreshState();\n        this.updateOriginalInput();\n    },\n\n    /**\n     * Updates all state-dependent attributes\n     * and CSS classes.\n     */\n    refreshState: function() {\n        this.refreshValidityState();\n        this.refreshClasses();\n    },\n\n    /**\n     * Update the `required` attribute of both input and control input.\n     *\n     * The `required` property needs to be activated on the control input\n     * for the error to be displayed at the right place. `required` also\n     * needs to be temporarily deactivated on the input since the input is\n     * hidden and can't show errors.\n     */\n    refreshValidityState: function() {\n        if (!this.isRequired) return false;\n\n        var invalid = !this.items.length;\n\n        this.isInvalid = invalid;\n        this.$control_input.prop('required', invalid);\n        this.$input.prop('required', !invalid);\n    },\n\n    /**\n     * Updates all state-dependent CSS classes.\n     */\n    refreshClasses: function() {\n        var self     = this;\n        var isFull   = self.isFull();\n        var isLocked = self.isLocked;\n\n        self.$wrapper\n            .toggleClass('rtl', self.rtl);\n\n        self.$control\n            .toggleClass('focus', self.isFocused)\n            .toggleClass('disabled', self.isDisabled)\n            .toggleClass('required', self.isRequired)\n            .toggleClass('invalid', self.isInvalid)\n            .toggleClass('locked', isLocked)\n            .toggleClass('full', isFull).toggleClass('not-full', !isFull)\n            .toggleClass('input-active', self.isFocused && !self.isInputHidden)\n            .toggleClass('dropdown-active', self.isOpen)\n            .toggleClass('has-options', !$.isEmptyObject(self.options))\n            .toggleClass('has-items', self.items.length > 0);\n\n        self.$control_input.data('grow', !isFull && !isLocked);\n    },\n\n    /**\n     * Determines whether or not more items can be added\n     * to the control without exceeding the user-defined maximum.\n     *\n     * @returns {boolean}\n     */\n    isFull: function() {\n        return this.settings.maxItems !== null && this.items.length >= this.settings.maxItems;\n    },\n\n    /**\n     * Refreshes the original <select> or <input>\n     * element to reflect the current state.\n     */\n    updateOriginalInput: function(opts) {\n        var i, n, options, label, self = this;\n        opts = opts || {};\n\n        if (self.tagType === TAG_SELECT) {\n            options = [];\n            for (i = 0, n = self.items.length; i < n; i++) {\n                label = self.options[self.items[i]][self.settings.labelField] || '';\n                options.push('<option value=\"' + escape_html(self.items[i]) + '\" selected=\"selected\">' + escape_html(label) + '</option>');\n            }\n            if (!options.length && !this.$input.attr('multiple')) {\n                options.push('<option value=\"\" selected=\"selected\"></option>');\n            }\n            self.$input.html(options.join(''));\n        } else {\n            self.$input.val(self.getValue());\n            self.$input.attr('value',self.$input.val());\n        }\n\n        if (self.isSetup) {\n            if (!opts.silent) {\n                self.trigger('change', self.$input.val());\n            }\n        }\n    },\n\n    /**\n     * Shows/hide the input placeholder depending\n     * on if there items in the list already.\n     */\n    updatePlaceholder: function() {\n        if (!this.settings.placeholder) return;\n        var $input = this.$control_input;\n\n        if (this.items.length) {\n            $input.removeAttr('placeholder');\n        } else {\n            $input.attr('placeholder', this.settings.placeholder);\n        }\n        $input.triggerHandler('update', {force: true});\n    },\n\n    /**\n     * Shows the autocomplete dropdown containing\n     * the available options.\n     */\n    open: function() {\n        var self = this;\n\n        if (self.isLocked || self.isOpen || (self.settings.mode === 'multi' && self.isFull())) return;\n        self.focus();\n        self.isOpen = true;\n        self.refreshState();\n        self.$dropdown.css({visibility: 'hidden', display: 'block'});\n        self.positionDropdown();\n        self.$dropdown.css({visibility: 'visible'});\n        self.trigger('dropdown_open', self.$dropdown);\n    },\n\n    /**\n     * Closes the autocomplete dropdown menu.\n     */\n    close: function() {\n        var self = this;\n        var trigger = self.isOpen;\n\n        if (self.settings.mode === 'single' && self.items.length) {\n            self.hideInput();\n\n            // Do not trigger blur while inside a blur event,\n            // this fixes some weird tabbing behavior in FF and IE.\n            // See #1164\n            if (self.isBlurring) {\n                self.$control_input.blur(); // close keyboard on iOS\n            }\n        }\n\n        self.isOpen = false;\n        self.$dropdown.hide();\n        self.setActiveOption(null);\n        self.refreshState();\n\n        if (trigger) self.trigger('dropdown_close', self.$dropdown);\n    },\n\n    /**\n     * Calculates and applies the appropriate\n     * position of the dropdown.\n     */\n    positionDropdown: function() {\n        var $control = this.$control;\n        var offset = this.settings.dropdownParent === 'body' ? $control.offset() : $control.position();\n        offset.top += $control.outerHeight(true);\n\n        this.$dropdown.css({\n            width : $control[0].getBoundingClientRect().width,\n            top   : offset.top,\n            left  : offset.left\n        });\n    },\n\n    /**\n     * Resets / clears all selected items\n     * from the control.\n     *\n     * @param {boolean} silent\n     */\n    clear: function(silent) {\n        var self = this;\n\n        if (!self.items.length) return;\n        self.$control.children(':not(input)').remove();\n        self.items = [];\n        self.lastQuery = null;\n        self.setCaret(0);\n        self.setActiveItem(null);\n        self.updatePlaceholder();\n        self.updateOriginalInput({silent: silent});\n        self.refreshState();\n        self.showInput();\n        self.trigger('clear');\n    },\n\n    /**\n     * A helper method for inserting an element\n     * at the current caret position.\n     *\n     * @param {object} $el\n     */\n    insertAtCaret: function($el) {\n        var caret = Math.min(this.caretPos, this.items.length);\n        var el = $el[0];\n        var target = this.buffer || this.$control[0];\n\n        if (caret === 0) {\n            target.insertBefore(el, target.firstChild);\n        } else {\n            target.insertBefore(el, target.childNodes[caret]);\n        }\n\n        this.setCaret(caret + 1);\n    },\n\n    /**\n     * Removes the current selected item(s).\n     *\n     * @param {object} e (optional)\n     * @returns {boolean}\n     */\n    deleteSelection: function(e) {\n        var i, n, direction, selection, values, caret, option_select, $option_select, $tail;\n        var self = this;\n\n        direction = (e && e.keyCode === KEY_BACKSPACE) ? -1 : 1;\n        selection = getSelection(self.$control_input[0]);\n\n        if (self.$activeOption && !self.settings.hideSelected) {\n            option_select = self.getAdjacentOption(self.$activeOption, -1).attr('data-value');\n        }\n\n        // determine items that will be removed\n        values = [];\n\n        if (self.$activeItems.length) {\n            $tail = self.$control.children('.active:' + (direction > 0 ? 'last' : 'first'));\n            caret = self.$control.children(':not(input)').index($tail);\n            if (direction > 0) { caret++; }\n\n            for (i = 0, n = self.$activeItems.length; i < n; i++) {\n                values.push($(self.$activeItems[i]).attr('data-value'));\n            }\n            if (e) {\n                e.preventDefault();\n                e.stopPropagation();\n            }\n        } else if ((self.isFocused || self.settings.mode === 'single') && self.items.length) {\n            if (direction < 0 && selection.start === 0 && selection.length === 0) {\n                values.push(self.items[self.caretPos - 1]);\n            } else if (direction > 0 && selection.start === self.$control_input.val().length) {\n                values.push(self.items[self.caretPos]);\n            }\n        }\n\n        // allow the callback to abort\n        if (!values.length || (typeof self.settings.onDelete === 'function' && self.settings.onDelete.apply(self, [values]) === false)) {\n            return false;\n        }\n\n        // perform removal\n        if (typeof caret !== 'undefined') {\n            self.setCaret(caret);\n        }\n        while (values.length) {\n            self.removeItem(values.pop());\n        }\n\n        self.showInput();\n        self.positionDropdown();\n        self.refreshOptions(true);\n\n        // select previous option\n        if (option_select) {\n            $option_select = self.getOption(option_select);\n            if ($option_select.length) {\n                self.setActiveOption($option_select);\n            }\n        }\n\n        return true;\n    },\n\n    /**\n     * Selects the previous / next item (depending\n     * on the `direction` argument).\n     *\n     * > 0 - right\n     * < 0 - left\n     *\n     * @param {int} direction\n     * @param {object} e (optional)\n     */\n    advanceSelection: function(direction, e) {\n        var tail, selection, idx, valueLength, cursorAtEdge, $tail;\n        var self = this;\n\n        if (direction === 0) return;\n        if (self.rtl) direction *= -1;\n\n        tail = direction > 0 ? 'last' : 'first';\n        selection = getSelection(self.$control_input[0]);\n\n        if (self.isFocused && !self.isInputHidden) {\n            valueLength = self.$control_input.val().length;\n            cursorAtEdge = direction < 0\n                ? selection.start === 0 && selection.length === 0\n                : selection.start === valueLength;\n\n            if (cursorAtEdge && !valueLength) {\n                self.advanceCaret(direction, e);\n            }\n        } else {\n            $tail = self.$control.children('.active:' + tail);\n            if ($tail.length) {\n                idx = self.$control.children(':not(input)').index($tail);\n                self.setActiveItem(null);\n                self.setCaret(direction > 0 ? idx + 1 : idx);\n            }\n        }\n    },\n\n    /**\n     * Moves the caret left / right.\n     *\n     * @param {int} direction\n     * @param {object} e (optional)\n     */\n    advanceCaret: function(direction, e) {\n        var self = this, fn, $adj;\n\n        if (direction === 0) return;\n\n        fn = direction > 0 ? 'next' : 'prev';\n        if (self.isShiftDown) {\n            $adj = self.$control_input[fn]();\n            if ($adj.length) {\n                self.hideInput();\n                self.setActiveItem($adj);\n                e && e.preventDefault();\n            }\n        } else {\n            self.setCaret(self.caretPos + direction);\n        }\n    },\n\n    /**\n     * Moves the caret to the specified index.\n     *\n     * @param {int} i\n     */\n    setCaret: function(i) {\n        var self = this;\n\n        if (self.settings.mode === 'single') {\n            i = self.items.length;\n        } else {\n            i = Math.max(0, Math.min(self.items.length, i));\n        }\n\n        if(!self.isPending) {\n            // the input must be moved by leaving it in place and moving the\n            // siblings, due to the fact that focus cannot be restored once lost\n            // on mobile webkit devices\n            var j, n, fn, $children, $child;\n            $children = self.$control.children(':not(input)');\n            for (j = 0, n = $children.length; j < n; j++) {\n                $child = $($children[j]).detach();\n                if (j <  i) {\n                    self.$control_input.before($child);\n                } else {\n                    self.$control.append($child);\n                }\n            }\n        }\n\n        self.caretPos = i;\n    },\n\n    /**\n     * Disables user input on the control. Used while\n     * items are being asynchronously created.\n     */\n    lock: function() {\n        this.close();\n        this.isLocked = true;\n        this.refreshState();\n    },\n\n    /**\n     * Re-enables user input on the control.\n     */\n    unlock: function() {\n        this.isLocked = false;\n        this.refreshState();\n    },\n\n    /**\n     * Disables user input on the control completely.\n     * While disabled, it cannot receive focus.\n     */\n    disable: function() {\n        var self = this;\n        self.$input.prop('disabled', true);\n        self.$control_input.prop('disabled', true).prop('tabindex', -1);\n        self.isDisabled = true;\n        self.lock();\n    },\n\n    /**\n     * Enables the control so that it can respond\n     * to focus and user input.\n     */\n    enable: function() {\n        var self = this;\n        self.$input.prop('disabled', false);\n        self.$control_input.prop('disabled', false).prop('tabindex', self.tabIndex);\n        self.isDisabled = false;\n        self.unlock();\n    },\n\n    /**\n     * Completely destroys the control and\n     * unbinds all event listeners so that it can\n     * be garbage collected.\n     */\n    destroy: function() {\n        var self = this;\n        var eventNS = self.eventNS;\n        var revertSettings = self.revertSettings;\n\n        self.trigger('destroy');\n        self.off();\n        self.$wrapper.remove();\n        self.$dropdown.remove();\n\n        self.$input\n            .html('')\n            .append(revertSettings.$children)\n            .removeAttr('tabindex')\n            .removeClass('selectized')\n            .attr({tabindex: revertSettings.tabindex})\n            .show();\n\n        self.$control_input.removeData('grow');\n        self.$input.removeData('selectize');\n\n        if (--Selectize.count == 0 && Selectize.$testInput) {\n            Selectize.$testInput.remove();\n            Selectize.$testInput = undefined;\n        }\n\n        $(window).off(eventNS);\n        $(document).off(eventNS);\n        $(document.body).off(eventNS);\n\n        delete self.$input[0].selectize;\n    },\n\n    /**\n     * A helper method for rendering \"item\" and\n     * \"option\" templates, given the data.\n     *\n     * @param {string} templateName\n     * @param {object} data\n     * @returns {string}\n     */\n    render: function(templateName, data) {\n        var value, id, label;\n        var html = '';\n        var cache = false;\n        var self = this;\n        var regex_tag = /^[\\t \\r\\n]*<([a-z][a-z0-9\\-_]*(?:\\:[a-z][a-z0-9\\-_]*)?)/i;\n\n        if (templateName === 'option' || templateName === 'item') {\n            value = hash_key(data[self.settings.valueField]);\n            cache = !!value;\n        }\n\n        // pull markup from cache if it exists\n        if (cache) {\n            if (!isset(self.renderCache[templateName])) {\n                self.renderCache[templateName] = {};\n            }\n            if (self.renderCache[templateName].hasOwnProperty(value)) {\n                return self.renderCache[templateName][value];\n            }\n        }\n\n        // render markup\n        html = $(self.settings.render[templateName].apply(this, [data, escape_html]));\n\n        // add mandatory attributes\n        if (templateName === 'option' || templateName === 'option_create') {\n            if (!data[self.settings.disabledField]) {\n                html.attr('data-selectable', '');\n            }\n        }\n        else if (templateName === 'optgroup') {\n            id = data[self.settings.optgroupValueField] || '';\n            html.attr('data-group', id);\n            if(data[self.settings.disabledField]) {\n                html.attr('data-disabled', '');\n            }\n        }\n        if (templateName === 'option' || templateName === 'item') {\n            html.attr('data-value', value || '');\n        }\n\n        // update cache\n        if (cache) {\n            self.renderCache[templateName][value] = html[0];\n        }\n\n        return html[0];\n    },\n\n    /**\n     * Clears the render cache for a template. If\n     * no template is given, clears all render\n     * caches.\n     *\n     * @param {string} templateName\n     */\n    clearCache: function(templateName) {\n        var self = this;\n        if (typeof templateName === 'undefined') {\n            self.renderCache = {};\n        } else {\n            delete self.renderCache[templateName];\n        }\n    },\n\n    /**\n     * Determines whether or not to display the\n     * create item prompt, given a user input.\n     *\n     * @param {string} input\n     * @return {boolean}\n     */\n    canCreate: function(input) {\n        var self = this;\n        if (!self.settings.create) return false;\n        var filter = self.settings.createFilter;\n        return input.length\n            && (typeof filter !== 'function' || filter.apply(self, [input]))\n            && (typeof filter !== 'string' || new RegExp(filter).test(input))\n            && (!(filter instanceof RegExp) || filter.test(input));\n    }\n\n});\n"],"file":"selectize.min.js"}